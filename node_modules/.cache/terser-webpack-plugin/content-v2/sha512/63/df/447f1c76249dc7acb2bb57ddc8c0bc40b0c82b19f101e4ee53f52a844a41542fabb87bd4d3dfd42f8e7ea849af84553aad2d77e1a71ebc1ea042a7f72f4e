{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{430:function(e,t,a){\"use strict\";a.d(t,\"d\",(function(){return r})),a.d(t,\"c\",(function(){return i})),a.d(t,\"b\",(function(){return l})),a.d(t,\"a\",(function(){return s}));var n=a(108);const r=function(e){return n.a.get(\"/order/list\",{params:e})},i=function(e){return n.a.get(\"/order/detail/\"+e)},l=function(){return n.a.get(\"/area\")},s=function(e){return n.a.post(\"/order/address\",e)}},628:function(e,t,a){\"use strict\";var n=a(165)(e.i,{locals:!1});e.hot.dispose(n),e.hot.accept(void 0,n)},781:function(e,t,a){\"use strict\";a.r(t),a.d(t,\"default\",(function(){return A}));var n=a(47),r=a(0),i=a.n(r),l=a(777),s=a(767),o=a(255),c=a(256),d=a(74),m=a(783),h=a(774),u=a(778),p=a(21),g=a.n(p),f=a(782);const E={order:{name:\"订单列表\",child:{info:{name:\"订单详情\"}}},goods:{name:\"商品列表\",child:{create:{name:\"创建商品\"},list:{name:\"商品列表\"}}}};class b extends r.Component{constructor(e){super(e),this.getPathArr=this.getPathArr.bind(this),this.getPath=this.getPath.bind(this),this.state={pathArr:[]}}getPath(){const e=this.state.pathArr;return g.a.map(e,(e,t)=>i.a.createElement(f.a.Item,{key:t},i.a.createElement(\"a\",{href:e.path},e.name)))}getPathArr(e){const t=[];t.push({name:E[e[0]].name,path:\"/\"+e[0]});const a=E[e[0]].child;return a&&t.push({name:a[e[1]].name,path:`/${e[0]}/${e[1]}`}),t}UNSAFE_componentWillMount(){const e=window.location.pathname,t=g.a.compact(e.split(\"/\")),a=this.getPathArr(t);this.setState({pathArr:a})}render(){return i.a.createElement(\"div\",{style:{marginBottom:\"15px\"}},i.a.createElement(f.a,null,this.getPath()))}}a(628);var C=a(776),v=a(764),V=a(780),y=a(430),_=a(111),w=a.n(_);const D={labelCol:{style:{width:\"120px\"}},autoComplete:\"off\"};class I extends r.Component{constructor(e){super(e),this.formRef=i.a.createRef(),this.formSpaceName=\"editAddress\",this.componentWillUnmount=()=>{this.setState=(e,t)=>{}},this.setFormVal=this.setFormVal.bind(this),this.onChangeValues=this.onChangeValues.bind(this),this.onFinish=this.onFinish.bind(this),this.getFieldValue=this.getFieldValue.bind(this),this.onCascaderChange=this.onCascaderChange.bind(this),this.state={area:[],userInfo:{}}}componentDidMount(){return Object(n.a)(this,void 0,void 0,(function*(){const e=this.props.form;e.area=[],e.address.addressId=e.address.id;const t=g.a.assign({},e,e.address);t.area=[].concat([],t.province_code,t.city_code,t.area_code),this.setFormVal(t);const a=(yield Object(y.b)())||[];this.setState({userInfo:t,area:[].concat([],a)})}))}setFormVal(e){if(this.formRef){const{current:t}=this.formRef;t&&t.setFieldsValue(e)}}onChangeValues(e){console.log(e)}onFinish(e){return Object(n.a)(this,void 0,void 0,(function*(){const t=this.state.userInfo,a=new w.a([],\"id\",\"pid\").flatten(this.state.area,\"children\"),n=new w.a(a,\"id\").select({area_code:e.area}),r={id:t.addressId,name:e.name,phone:e.member_phone,detail:e.detail,province_code:e.area[0],city_code:e.area[1],area_code:e.area[2],province:n[0].area_name,city:n[1].area_name,area:n[2].area_name},{id:i}=yield Object(y.a)(r);i&&(this.props.getOrderInfo(),this.props.handleConsigneeCancel())}))}getFieldValue(e){if(this.formRef){const{current:t}=this.formRef;if(t&&t.getFieldValue){return t.getFieldValue(e)}}}onCascaderChange(e){console.log(e)}getNameView(){return i.a.createElement(C.a.Item,{name:\"name\",label:\"姓名\",rules:[{required:!0}]},i.a.createElement(v.a,{placeholder:\"请输入姓名\"}))}getTelView(){return i.a.createElement(C.a.Item,{name:\"member_phone\",label:\"联系方式\",rules:[{required:!0}]},i.a.createElement(v.a,{style:{width:\"100%\"},placeholder:\"请输入联系方式\",maxLength:length}))}getAreaView(){const e=this.state,t=[{required:!0}];if(e.userInfo.area)return i.a.createElement(C.a.Item,{name:\"area\",label:\"省市区\",rules:t},i.a.createElement(V.a,{options:e.area,onChange:this.onCascaderChange,fieldNames:{value:\"area_code\",label:\"area_name\"},placeholder:\"请选择省市区\"}))}getAddressView(){return i.a.createElement(C.a.Item,{name:\"detail\",label:\"地址\",rules:[{required:!0}]},i.a.createElement(v.a,{style:{width:\"100%\"},placeholder:\"请输入地址\"}))}getContent(){this.state;const e=Object.assign(Object.assign({},D),{layout:{labelCol:{span:6},wrapperCol:{span:16}},initialValues:{name:\"\"},ref:this.formRef,name:this.formSpaceName,onFinish:this.onFinish,onValuesChange:this.onChangeValues});return i.a.createElement(C.a,Object.assign({},e),this.getNameView(),this.getTelView(),this.getAreaView(),this.getAddressView(),i.a.createElement(C.a.Item,null,i.a.createElement(\"div\",{className:\"form-btn\"},i.a.createElement(d.a,{type:\"primary\",className:\"mr20\",onClick:this.props.handleConsigneeCancel,htmlType:\"submit\"},\"取消\"),i.a.createElement(d.a,{type:\"primary\",htmlType:\"submit\"},\"保存\"))))}render(){return i.a.createElement(\"div\",null,i.a.createElement(\"div\",null,this.getContent()))}}var F=a(509);const{Option:O}=F.a,N={labelCol:{style:{width:\"120px\"}},autoComplete:\"off\"};class k extends r.Component{constructor(e){super(e),this.formRef=i.a.createRef(),this.formSpaceName=\"deliverGoods\",this.onChangeValues=this.onChangeValues.bind(this),this.setFormVal=this.setFormVal.bind(this),this.onGenderChange=this.onGenderChange.bind(this),this.onFinish=this.onFinish.bind(this)}componentDidMount(){this.setFormVal(this.props.form)}setFormVal(e){if(this.formRef){const{current:t}=this.formRef;t&&t.setFieldsValue(e)}}onChangeValues(e){console.log(e)}onFinish(e){console.log(e)}getFieldValue(e){if(this.formRef){const{current:t}=this.formRef;if(t&&t.getFieldValue){return t.getFieldValue(e)}}}onGenderChange(e){console.log(e)}getCompanyView(){return i.a.createElement(C.a.Item,{name:\"company\",label:\"地址\",rules:[{required:!0}]},i.a.createElement(F.a,{placeholder:\"请选择物流公司\",onChange:this.onGenderChange,allowClear:!0},[{name:\"韵达\",id:1},{name:\"顺丰\",id:2}].map(e=>i.a.createElement(O,{key:e.id,value:e.id},e.name))))}getOddNumView(){return i.a.createElement(C.a.Item,{name:\"add\",label:\"地址\",rules:[{required:!0}]},i.a.createElement(v.a,{style:{width:\"100%\"},placeholder:\"请输入地址\"}))}getContent(){const e=Object.assign(Object.assign({},N),{layout:{labelCol:{span:6},wrapperCol:{span:16}},ref:this.formRef,name:this.formSpaceName,onFinish:this.onFinish,onValuesChange:this.onChangeValues});return i.a.createElement(C.a,Object.assign({},e),this.getCompanyView(),this.getOddNumView(),i.a.createElement(C.a.Item,{label:\"\"},i.a.createElement(\"p\",{className:\"tip\"},\"* 请仔细填写物流公司及物流单号，发货后暂不支持修改\")),i.a.createElement(C.a.Item,null,i.a.createElement(\"div\",{className:\"form-btn\"},i.a.createElement(d.a,{type:\"primary\",className:\"mr20\",onClick:this.props.handleDeliverCancel},\"取消\"),i.a.createElement(d.a,{type:\"primary\",htmlType:\"submit\"},\"保存\"))))}render(){return i.a.createElement(\"div\",null,i.a.createElement(\"div\",null,this.getContent()))}}class R{constructor(){this.orderDetail={address:{},order_sub:[]},this.a1=100,this.height=100,this.statusMap={1:\"普通订单\",2:\"加急订单\"},this.isConsigneeVisible=!1,this.isDeliverVisible=!1,this.consigneeForm={}}}class A extends r.Component{constructor(e){super(e),this.formRef=i.a.createRef(),this.state=new R,this.showModal=this.showModal.bind(this),this.deliverGoodsBtn=this.deliverGoodsBtn.bind(this),this.handleConsigneeCancel=this.handleConsigneeCancel.bind(this),this.handleDeliverCancel=this.handleDeliverCancel.bind(this),this.getOrderInfo=this.getOrderInfo.bind(this)}componentDidMount(){this.getOrderInfo()}getOrderInfo(){return Object(n.a)(this,void 0,void 0,(function*(){const e=this.props.location.query.id||\"\",t=yield Object(y.c)(e);this.setState({orderDetail:t})}))}getTitle(){return i.a.createElement(\"p\",{className:\"title\"},\"商品信息\")}showModal(){this.setState({isConsigneeVisible:!0})}deliverGoodsBtn(){this.setState({isDeliverVisible:!0})}handleConsigneeCancel(){this.setState({isConsigneeVisible:!1})}getFieldValue(e){if(this.formRef){const{current:t}=this.formRef;if(t&&t.getFieldValue){return t.getFieldValue(e)}}}handleDeliverCancel(){this.setState({isDeliverVisible:!1})}getEditAddress(){if(this.state.orderDetail)return i.a.createElement(I,{key:Math.random(),getOrderInfo:this.getOrderInfo,handleConsigneeCancel:this.handleConsigneeCancel,form:this.state.orderDetail})}getDeliverGoods(){if(this.state.consigneeForm)return i.a.createElement(k,{handleDeliverCancel:this.handleDeliverCancel,form:this.state.consigneeForm})}render(){const e=this.state,t=[{title:\"商品名称\",key:\"goods_name\",dataIndex:\"goods_name\",width:300,render:(e,t)=>i.a.createElement(\"div\",null,i.a.createElement(l.a,{className:\"mr20\",width:40,height:40,src:e.goods_sku_image}),i.a.createElement(s.b,{className:\"ml20\",size:\"middle\"},i.a.createElement(\"a\",null,t.goods_name)))},{title:\"规格\",dataIndex:\"goods_sku_name\",key:\"goods_sku_name\",align:\"center\"},{title:\"数量\",dataIndex:\"amount\",key:\"amount\",align:\"center\"},{title:\"订单价格\",key:\"goods_price\",align:\"center\",render:e=>i.a.createElement(\"div\",null,(e.goods_price||0)/100,\"元\")},{title:\"运费\",key:\"address\",align:\"center\",render:e=>i.a.createElement(\"div\",null,(e.goods_price||0)/100,\"元\")},{title:\"优惠\",key:\"discount_price\",align:\"center\",render:e=>i.a.createElement(\"div\",null,(e.discount_price||0)/100,\"元\")},{title:\"实付金额\",key:\"real_price\",align:\"center\",render:e=>i.a.createElement(\"div\",null,(e.real_price||0)/100,\"元\")}];return i.a.createElement(\"div\",null,i.a.createElement(b,null),i.a.createElement(\"div\",null,i.a.createElement(\"span\",{className:\"mr20\"},\"待发货\")),i.a.createElement(o.a,{className:\"mb10\"},i.a.createElement(c.a,{span:8},i.a.createElement(\"div\",null,\"订单信息\")),i.a.createElement(c.a,{span:8},i.a.createElement(\"span\",{className:\"mr20\"},\"收货信息\"),i.a.createElement(d.a,{type:\"primary\",size:\"middle\",onClick:this.showModal},\"修改\")),i.a.createElement(c.a,{span:8},\"买家信息\")),i.a.createElement(m.a,{title:\"\"},i.a.createElement(m.a.Item,{label:\"订单号\"},i.a.createElement(\"span\",null,e.orderDetail.order_no)),i.a.createElement(m.a.Item,{label:\"收货人姓名\"},i.a.createElement(\"span\",null,e.orderDetail.address.name)),i.a.createElement(m.a.Item,{label:\"买家昵称\"},i.a.createElement(\"span\",null,e.orderDetail.member_nickname)),i.a.createElement(m.a.Item,{label:\"支付时间：\"},i.a.createElement(\"span\",null,e.orderDetail.pay_time)),i.a.createElement(m.a.Item,{label:\"收货人联系方式：\"},i.a.createElement(\"span\",null,e.orderDetail.address.phone)),i.a.createElement(m.a.Item,{label:\"买家ID：\"},i.a.createElement(\"span\",null,e.orderDetail.member_id)),i.a.createElement(m.a.Item,{label:\"下单时间：\"},i.a.createElement(\"span\",null,e.orderDetail.created_at)),i.a.createElement(m.a.Item,{label:\"收货人地址：\"},i.a.createElement(\"span\",null,e.orderDetail.address.province,e.orderDetail.address.city,e.orderDetail.address.area,e.orderDetail.address.detail)),i.a.createElement(m.a.Item,{label:\"买家手机号：\"},i.a.createElement(\"span\",null,e.orderDetail.member_phone))),i.a.createElement(o.a,null,i.a.createElement(c.a,{span:24},i.a.createElement(\"span\",null,\"订单金额：\"),i.a.createElement(\"span\",null,(e.orderDetail.goods_price||0)/100,\"元\")),i.a.createElement(c.a,{span:24},i.a.createElement(\"span\",null,\"实付金额：\"),i.a.createElement(\"span\",null,(e.orderDetail.real_price||0)/100,\"元\")),i.a.createElement(c.a,{span:24},i.a.createElement(\"span\",null,\"运费：\"),i.a.createElement(\"span\",null,(e.orderDetail.freight_price||0)/100,\"元\")),i.a.createElement(c.a,{span:24},i.a.createElement(\"span\",null,\"优惠金额：\"),i.a.createElement(\"span\",null,(e.orderDetail.discount_price||0)/100,\"元\"))),this.getTitle(),i.a.createElement(h.a,{columns:t,bordered:!0,dataSource:e.orderDetail.order_sub,pagination:!1,rowKey:\"id\"}),i.a.createElement(u.a,{title:\"收货人地址\",visible:e.isConsigneeVisible,footer:null,onCancel:this.handleConsigneeCancel},this.getEditAddress()),i.a.createElement(u.a,{title:\"发货\",visible:e.isDeliverVisible,footer:null,onCancel:this.handleDeliverCancel},this.getDeliverGoods()))}}}}]);","extractedComments":[]}