{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{269:function(e,t,a){\"use strict\";a.d(t,\"f\",(function(){return i})),a.d(t,\"i\",(function(){return s})),a.d(t,\"d\",(function(){return o})),a.d(t,\"c\",(function(){return r})),a.d(t,\"b\",(function(){return l})),a.d(t,\"a\",(function(){return d})),a.d(t,\"e\",(function(){return c})),a.d(t,\"g\",(function(){return h})),a.d(t,\"h\",(function(){return u}));var n=a(108);function i(e){return n.a.get(\"/goods/list\",{params:e})}function s(e){return n.a.post(\"/goods/status\",e)}function o(e){return n.a.post(\"/goods/del\",e)}function r(){return n.a.get(\"/goods/category/list\")}function l(e){return n.a.post(\"/goods/category/add\",e)}function d(e){return n.a.post(\"/goods/add\",e)}function c(e){return n.a.get(\"/goods/detail/\"+e)}function h(){return n.a.get(\"/goods/spec/list\")}function u(e){return n.a.post(\"/goods/spec/add\",e)}},474:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return n}));const n=[{required:!1}]},475:function(e,t,a){\"use strict\";var n,i,s,o,r;a.d(t,\"d\",(function(){return n})),a.d(t,\"e\",(function(){return i})),a.d(t,\"b\",(function(){return s})),a.d(t,\"a\",(function(){return o})),a.d(t,\"c\",(function(){return r})),function(e){e[e.substance=1]=\"substance\",e[e.invented=2]=\"invented\"}(n||(n={})),function(e){e[e.submit=1]=\"submit\",e[e.pay=2]=\"pay\"}(i||(i={})),function(e){e[e.arbitrarily=0]=\"arbitrarily\",e[e.limit=1]=\"limit\"}(s||(s={})),function(e){e.arbitrarily=\"0\",e.limit=\"1\"}(o||(o={})),function(e){e[e.normal=1]=\"normal\",e[e.prohibit=2]=\"prohibit\",e[e.sellOut=3]=\"sellOut\"}(r||(r={}))},476:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return g}));var n=a(47),i=a(0),s=a.n(i),o=(a(477),a(779)),r=a(164),l=a(776),d=a(764),c=a(74),h=a(788),u=a(789),m=a(269);const{Panel:p}=o.a;class g extends i.Component{constructor(e){super(e),this.formRef=s.a.createRef(),this.formSpaceName=\"\",this.componentWillUnmount=()=>{this.setState=(e,t)=>{}},this.state={categoryList:[]},this.onChangeValues=this.onChangeValues.bind(this),this.addMenuOne=this.addMenuOne.bind(this),this.addFirstLevelCategory=this.addFirstLevelCategory.bind(this),this.delMenuOne=this.delMenuOne.bind(this),this.onFinish=this.onFinish.bind(this),this.getGoodsCategoryList=this.getGoodsCategoryList.bind(this),this.addCategory=this.addCategory.bind(this),this.iptBlue=this.iptBlue.bind(this)}componentDidMount(){this.props.getComponentRef(\"addClass\",this.state.menu),this.getGoodsCategoryList()}getGoodsCategoryList(){return Object(n.a)(this,void 0,void 0,(function*(){const e=yield Object(m.c)();this.setState({categoryList:[].concat(e)})}))}addMenuOne(e,t){e.stopPropagation(),console.log(t,\"inde\");const a=this.state.categoryList;a[t].child||(a[t].child=[]),a[t].child.push({name:\"\"}),this.setState({categoryList:a})}delMenuOne(e,t){e.stopPropagation();const a=this.state.categoryList;a.splice(t,1),this.setState({categoryList:a})}addFirstLevelCategory(){const{current:e}=this.formRef,{oneVal:t}=e.getFieldsValue();t?(this.addCategory(t,0),e.setFieldsValue({oneVal:void 0})):r.b.warning(\"请输入一级类目名称\")}addCategory(e,t){return Object(n.a)(this,void 0,void 0,(function*(){(yield Object(m.b)({name:e,pid:t})).id&&this.getGoodsCategoryList()}))}onChangeValues(e){console.log(e)}onFinish(){console.log(this.state.menu)}iptChange(e,t,a,n){const i=this.state.categoryList,s=e.target;if(s){const e=s.value;i[t].child[a].name=e,this.setState({categoryList:i})}}iptBlue(e,t,a,n){const i=this.state.categoryList,s=e.target;if(s){const e=s.value;i[t].child[a].name=e,this.addCategory(e,n)}}getFieldValue(e){if(this.formRef){const{current:t}=this.formRef;if(t&&t.getFieldValue){return t.getFieldValue(e)}}}getFormNode(){return s.a.createElement(l.a,{ref:this.formRef},s.a.createElement(\"div\",{className:\"center\"},s.a.createElement(l.a.Item,{name:\"oneVal\"},s.a.createElement(d.a,{placeholder:\"请输入要添加的一级类目\"})),s.a.createElement(c.a,{className:\"ml10\",type:\"primary\",onClick:this.addFirstLevelCategory},\"添加一级类目\")))}getContent(){const e=this.state;return s.a.createElement(\"div\",null,s.a.createElement(\"div\",null,this.getFormNode()),s.a.createElement(o.a,{defaultActiveKey:[\"0\"]},e.categoryList.map((e,t)=>s.a.createElement(p,{header:e.name,key:t,extra:s.a.createElement(\"div\",null,s.a.createElement(h.a,{onClick:e=>this.addMenuOne(e,t)}),s.a.createElement(u.a,{className:\"ml10\",onClick:e=>this.delMenuOne(e,t)}))},e.child&&e.child.map((a,n)=>s.a.createElement(\"div\",{className:\"mb10\",key:n},s.a.createElement(d.a,{maxLength:6,value:a.name,onBlur:a=>{this.iptBlue(a,t,n,e.id)},onChange:a=>{this.iptChange(a,t,n,e.id)}})))))))}render(){return s.a.createElement(\"div\",null,s.a.createElement(\"div\",null,this.getContent()))}}},477:function(e,t,a){\"use strict\";var n=a(165)(e.i,{locals:!1});e.hot.dispose(n),e.hot.accept(void 0,n)},478:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return l}));var n=a(47),i=a(0),s=a.n(i),o=a(775),r=a(790);class l extends s.a.Component{constructor(e){super(e),this.state={fileList:[]},this.onUpload=this.onUpload.bind(this),this.onUploadChange=this.onUploadChange.bind(this)}componentDidMount(){this.setState({fileList:[].concat(this.props.fileList)})}onUploadChange(e){console.log(e)}onFileUpload(e){return Object(n.a)(this,void 0,void 0,(function*(){try{const t=yield function(e){return new Promise((t,a)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=function(){t(n.result)},n.onerror=function(e){a(e)}})}(e);this.props.onChange(t),this.props.onSuccess&&this.props.onSuccess(t)}catch(e){console.log(e)}}))}onUpload(e){return this.props.onChange&&this.onFileUpload(e),!1}getContent(){return this.props.imgSrc?s.a.createElement(\"img\",{className:\"dibk\",width:100,src:this.props.imgSrc}):s.a.createElement(r.a,null)}render(){this.props.fileListasd;const e={name:\"file\",multiple:!1,listType:\"picture-card\",fileList:[],showUploadList:!1,onChange:this.onUploadChange,beforeUpload:this.onUpload};return s.a.createElement(o.a,Object.assign({},e),this.getContent())}}},479:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return l}));var n=a(47),i=a(0),s=a.n(i),o=a(660),r=a.n(o);a(756);class l extends s.a.Component{constructor(e){super(e),this.state={editorState:void 0},this.submitContent=this.submitContent.bind(this),this.handleEditorChange=this.handleEditorChange.bind(this)}componentDidMount(){return Object(n.a)(this,void 0,void 0,(function*(){console.log(this.props);const e=this.props.value||\"\";this.setState({editorState:r.a.createEditorState(e)})}))}submitContent(){return Object(n.a)(this,void 0,void 0,(function*(){if(this.props.onChange){const e=this.state.editorState.toHTML();this.props.onChange(e)}}))}handleEditorChange(e){this.setState({editorState:e},()=>{this.submitContent()})}render(){const{editorState:e}=this.state;return s.a.createElement(\"div\",{className:\"editor-box border\"},s.a.createElement(r.a,{value:e,onChange:this.handleEditorChange,onSave:this.submitContent}))}}},508:function(e,t,a){\"use strict\";a.d(t,\"b\",(function(){return b})),a.d(t,\"c\",(function(){return f})),a.d(t,\"a\",(function(){return y}));var n=a(47),i=a(0),s=a.n(i),o=a(509),r=a(164),l=a(776),d=a(764),c=a(74),h=a(774),u=a(778),m=a(269),p=a(21),g=a.n(p);a(477);const b={labelCol:{span:6},wrapperCol:{span:16}},f={wrapperCol:{offset:8,span:16}};class y extends i.Component{constructor(e){super(e),this.formRef=s.a.createRef(),this.componentWillUnmount=()=>{this.setState=(e,t)=>{}},this.state={tableList:[],categoryOpt:[],selectedItem:\"\",nameModalVisible:!1,sizeModalVisible:!1,sizeKey:\"\"},this.getGoodsSpec=this.getGoodsSpec.bind(this),this.getCategoryView=this.getCategoryView.bind(this),this.handleChange=this.handleChange.bind(this),this.addNmaeHandle=this.addNmaeHandle.bind(this),this.onFinish=this.onFinish.bind(this),this.handleAdd=this.handleAdd.bind(this),this.sizeModelFinish=this.sizeModelFinish.bind(this)}componentDidMount(){this.getGoodsSpec.bind(this),this.props.getComponentRef(\"category\",this.state.tableList),this.setState({tableList:[].concat(this.props.goods_sku)}),this.getGoodsSpec()}setInitState(){return{tableList:[],categoryOpt:[],selectedItem:[]}}getGoodsSpec(){return Object(n.a)(this,void 0,void 0,(function*(){const e=yield Object(m.g)(),t=g.a.each(e,e=>({spec_id:e.spec_id,spec_name:e.spec_name}));this.setState({categoryOpt:t})}))}getCategoryView(){const{selectedItem:e,categoryOpt:t}=this.state;return s.a.createElement(\"div\",null,s.a.createElement(o.a,{value:e,onChange:this.handleChange,style:{width:150}},t.map(e=>s.a.createElement(o.a.Option,{key:e.spec_id,value:e.spec_id},e.spec_name))))}handleChange(e){this.setState({selectedItem:e})}addNmaeHandle(e){this.setState({nameModalVisible:e})}addSizeHandle(e){this.setState({sizeModalVisible:e}),this.setState({sizeKey:Math.random()})}onFinish(e){return Object(n.a)(this,void 0,void 0,(function*(){const{id:t}=yield Object(m.h)(e);t&&(this.addNmaeHandle(!1),this.getGoodsSpec(),r.b.success(\"添加成功\"))}))}sizeModelFinish(e){const t=this.state.tableList;e.spec_id=this.state.selectedItem,this.setState({tableList:[].concat(t,e)}),this.addSizeHandle(!1),this.props.getComponentRef(\"category\",this.state.tableList)}getAddNmaeView(){return s.a.createElement(l.a,Object.assign({},b,{name:\"basic\",onFinish:this.onFinish}),s.a.createElement(l.a.Item,{label:\"规格名称\",name:\"spec_name\",rules:[{required:!0,message:\"请输入规格名称\"}]},s.a.createElement(d.a,null)),s.a.createElement(l.a.Item,Object.assign({},f),s.a.createElement(c.a,{type:\"primary\",htmlType:\"submit\"},\"确定\")))}handleAdd(e){console.log(\"value: \",e)}getSizeView(){return s.a.createElement(l.a,Object.assign({key:this.state.sizeKey},b,{name:\"size\",onFinish:this.sizeModelFinish}),s.a.createElement(l.a.Item,{label:\"规格名称\",name:\"name\",rules:[{required:!0,message:\"Please input your username!\"}]},s.a.createElement(d.a,null)),s.a.createElement(l.a.Item,{label:\"成本价\",name:\"cost_price\",rules:[{required:!0,message:\"Please input your password!\"}]},s.a.createElement(d.a,null)),s.a.createElement(l.a.Item,{label:\"原价\",name:\"original_price\",rules:[{required:!0,message:\"Please input your password!\"}]},s.a.createElement(d.a,null)),s.a.createElement(l.a.Item,{label:\"售价\",name:\"selling_price\",rules:[{required:!0,message:\"Please input your password!\"}]},s.a.createElement(d.a,null)),s.a.createElement(l.a.Item,{label:\"库存\",name:\"stock\",rules:[{required:!0,message:\"Please input your password!\"}]},s.a.createElement(d.a,null)),s.a.createElement(l.a.Item,{label:\"实际销量\",name:\"sales\",rules:[{required:!0,message:\"Please input your password!\"}]},s.a.createElement(d.a,null)),s.a.createElement(l.a.Item,Object.assign({},f),s.a.createElement(c.a,{type:\"primary\",htmlType:\"submit\"},\"确定\")))}tableDel(e){let t;const a=this.state.tableList;for(let n=0;n<a.length;n++)if(e.id===a[n].id){t=n;break}a.splice(t,1),this.setState({tableList:[].concat(a)})}getTable(){const e=[{title:\"规格名称\",dataIndex:\"name\"},{title:\"成本价\",dataIndex:\"cost_price\",render:e=>s.a.createElement(\"a\",null,\"￥\",e)},{title:\"原价\",dataIndex:\"original_price\",render:e=>s.a.createElement(\"a\",null,\"￥\",e)},{title:\"售价\",dataIndex:\"selling_price\",render:e=>s.a.createElement(\"a\",null,\"￥\",e)},{title:\"库存\",dataIndex:\"stock\"},{title:\"实际销量\",dataIndex:\"sales\"},{title:\"操作\",key:\"id\",render:(e,t)=>s.a.createElement(\"div\",null,s.a.createElement(c.a,{className:\"mr20\",size:\"middle\",type:\"primary\"},\"编辑\"),s.a.createElement(\"a\",{onClick:()=>this.tableDel(t)},\"删除\"))}];if(this.state.tableList&&this.state.tableList.length)return s.a.createElement(h.a,{bordered:!0,dataSource:this.state.tableList,columns:e,pagination:!1,rowKey:\"id\",size:\"small\"})}render(){const e=this.state;return s.a.createElement(\"div\",null,s.a.createElement(l.a,{name:\"name\",className:\"name\",initialValues:{remember:!0}},s.a.createElement(l.a.Item,{label:\"规格名称\"},this.getCategoryView()),s.a.createElement(c.a,{className:\"ml20 mr20\",type:\"primary\",onClick:()=>{this.addNmaeHandle(!0)}},\"添加规格名称\"),s.a.createElement(c.a,{type:\"primary\",onClick:()=>{this.addSizeHandle(!0)}},\"添加规格值\")),s.a.createElement(u.a,{title:\"商品规格名称\",visible:e.nameModalVisible,footer:null,onCancel:()=>{this.addNmaeHandle(!1)}},this.getAddNmaeView()),s.a.createElement(\"div\",{className:\"mt20\"},s.a.createElement(u.a,{title:\"商品规格名称\",visible:e.sizeModalVisible,footer:null,onCancel:()=>{this.addSizeHandle(!1)}},this.getSizeView()),s.a.createElement(\"div\",{className:\"mt20\"},this.getTable())))}}}}]);","extractedComments":[]}